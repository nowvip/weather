name: Download HATQ Video

on:
  workflow_dispatch:
  
jobs:
  download:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Download video
      run: |
        mkdir -p videos
        curl -L "https://f.video.weibocdn.com/o0/upYsSAfSlx08hPMFjUF20104120146750E010.mp4?label=mp4_720p&template=1280x720.25.0&ori=0&ps=1BVp4ysnknHVZu&Expires=1725728728&ssig=P2ym9Il6Kl&KID=unistore,video" -o videos/my_video.mp4

    - name: Commit video to repository
      run: |
        git config --global user.name 'GitHub Actions'
        git config --global user.email 'actions@github.com'
        
        # 添加文件到暂存区
        git add videos/my_video.mp4
        
        # 检查是否有更改
        if [[ `git status --porcelain` ]]; then
          git commit -m 'Add downloaded video'
          git push
        else
          echo "No changes to commit"
        fi
